
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Orders - Econaz Order Manager</title>
  <link rel="stylesheet" href="order.css?v=1695738008">
  <link rel="stylesheet" href="user.css?v=1695738008">
  <link rel="stylesheet" href="dashboard.css?v=1695738008">
  <link rel="stylesheet" href="style.css?v=1695738008">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>

<body>
    <div class="wrapper">
    <div id="sidebar">
      <ul>
        <a href="?page=orders"><li data-name="Orders">
          <i class="fa-solid fa-cart-shopping open"></i>
        </li></a>
        <a href="?page=users"><li data-name="User">
          <i class="fa-solid fa-user "></i>
        </li></a>
        <a href="?page=websites"><li data-name="Websites"><i class="fa-solid fa-up-right-from-square "></i></li></a>
        <a href="?page=logs"><li data-name="Logs"><i class="fa-solid fa-message "></i></i></li></a>
        <a href="?page=settings"><li data-name="Settings"><i class="fa-solid fa-gear "></i></li></a>
        <a href="?page=logout"><li data-name="Logout"><i class="fa-solid fa-power-off "></i></li></a>
      </ul>
      
    </div>
    <div id="main-content">
      <div class="search-bar">
        <marquee>This system under development. If you have any question kindly ask here: sajonybd@gmail.com</marquee>
        <!--<input type="text" placeholder="search product, order, customer..." id="search">-->
        <div id="noti-icon">
          <i class="fa-solid fa-bell" id="show-noti"></i>
        </div>
      </div>
      <div class="main-context">          <div class="order-tabs">
            <div class="order-tabs-desc">
              <div>
                <span>1</span>
                <button class="tab-bg" order-filter="all">All order (<span id="all_order">0</span>)</button>
              </div>
              <div>
                <span>2</span>
                <button order-filter="process">process </button>
              </div>
              <div>
                <span>3</span>
                <button order-filter="confirmed">confirmed</button>
              </div>
              <div>
                <span>4</span>
                <button order-filter="processing">Processing</button>
              </div>
              <div>
                <span>5</span>
                <button order-filter="transit">In transit</button>
              </div>
              <div>
                <span>6</span>
                <button order-filter="refunded">refunded</button>
              </div>
              <div>
                <span>7</span>
                <button order-filter="return">Return</button>
              </div>
              <div>
                <span>8</span>
                <button order-filter="cancel">Cancel</button>
              </div>
              <div>
                <span>9</span>
                <button order-filter="trash">Trash</button>
              </div>
              <div>
                <span>10</span>
                <button order-filter="on-hold">on hold</button>
              </div>
            </div>
          </div>

          <!-- search bar starts here -->

          <div class="order-search-box">
            <input type="text" placeholder="search order id / mobile number..." class="search-order">
          </div>


          <script>


          </script>


          <!-- search bar end here -->


          <div class="order-time">
            <!--<span>last week</span>-->
          </div>

          <script>
            let total;
            let pp;
            let p;
            let s;
            let cp;
            
            fetch('https://staging.skmeibangladesh.com/wp-json/wc/v3/orders', {
              headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Basic Y2tfNDQ4ZTk0NTM0YjE2YWUzZWRmZTA2M2RlMWM3ODRiM2M4ZDZlMWVkMTpjc183MDhjMjIzMDA4M2ZhMDQ5MzI2MTIwODU1NDM3MjdiYmFhZDBhNzM1',
              }
            })
              .then((response) => response.json())
              .then(data => orderList(data));
            function orderList(data) {
            localStorage["orders"] = JSON.stringify(data);
            showMore(1);
            
              // ------------------- edit details starts from here ---------------------------
              let isClickf = 0;
              let billEdit = document.querySelector(".ed-bill-btn");
              billEdit.addEventListener("click", () => {
                isClickf++;
                if (isClickf % 2 == 1) {
                  let obbedBl = document.querySelector(".obb-bl-n")
                  obbedBl.contentEditable = true;
                  obbedBl.style.border = "2px solid gray";
                  obbedBl.style.padding = "5px";
                }
                if (isClickf % 2 == 0) {
                  let obbedBl = document.querySelector(".obb-bl-n")
                  obbedBl.contentEditable = false;
                }
              })

              let phoneEditBtn = document.querySelector(".ed-phone-btn");
              phoneEditBtn.addEventListener("click", () => {
                isClickf++;
                if (isClickf % 2 == 1) {
                  let obPhChange = document.querySelector(".obb-tl-id")
                  obPhChange.contentEditable = true;
                  obPhChange.style.border = "2px solid gray";
                  obPhChange.style.padding = "5px";
                }
                if (isClickf % 2 == 0) {
                  let obPhChange = document.querySelector(".obb-tl-id")
                  obPhChange.contentEditable = false;
                }
              })




            }
            
            function showMore(page) {
            let data = JSON.parse(localStorage["orders"]);
            total = data.length;
            pp = 2;
            cp = page * pp;
            p = Math.round(total / pp); 
            s = cp - pp;
            document.getElementById("all_order").innerHTML = total;
            document.getElementById("order").innerHTML = '';
            document.getElementById("pages").innerHTML = '';
            for (i = 1; i <= p; i++) {
            document.getElementById("pages").innerHTML += `<li onclick="showMore(${i})">${i}</li>`;
            }
            for (i = s; i < cp; i++) {
            let obj = data[i];
            document.getElementById("order").innerHTML += `<div class="order-card" id="${obj.id}" data-phone="${obj.billing.phone}" order-filter="${obj.status}">
                        <div class="o-topbar">
                            <div class="otb-left">
                                <p class="otb-1">${obj.id} <br> webName</p>
                                <p class="cc-name">${obj.billing.first_name}</p>
                                <div class="otb-process">
                                    <div class="otb2"></div>
                                    <span class="otb3">${obj.status}</span>
                                </div>
                                <div class="otb-time">
                                    ${obj.date_created} <br> ${obj.payment_method_title}
                        
                                </div>
                                <img src="${obj.line_items[0].image.src}" alt="img" class="ot-img">
                            </div>
                            <div class="print-icon">
                              <img src="images/print_icon.png" alt="print">
                            </div>
                            <div class="o-invoice-n">
                              ${obj.id}
                            </div>
                            <div class="otb-price">
                              &#2547; ${obj.total}
                            </div>
                            <div class="otb-bkash-trx-id">
                                A1H17UP0Q
                            </div>
                            <div class="otb-note-box">
                                note
                            </div>
                        </div>
                        <div class="o-bottombar">
                            <div class="obb-left">
                                <img src="${obj.line_items[0].image.src}" class="obb-l-img">
                              <div class="obb-heading">
                                    <p>product_name</p>
                                    <p>${obj.total} * <span class="obb-quantity">1</span> = ${obj.total}</p>
                              </div>
                            </div>
                          <div class="obb-center">
                                <div class="obb-telephone">
                                    <p class="obb-h">Phone</p>
                                    <a href="tel:${obj.billing.phone}" class="obb-tl-id cc-phone-n">${obj.billing.phone}</a>
                                </div>
                               <div class="obb-billing-address"> 
                                    <p class="obb-h">Billing Address</p>
                                    <p class="obb-bl-n">${obj.billing.address_1} ${obj.billing.address_2}</p>
                                </div>
                            <div>
                          </div>   
                          
                          <div class="order-status">
                          <div>
                            <span class="ss-span"></span>
                            <button>Process</button>
                          </div>
                          
                          <div>
                            <span  class="ss-span"></span>
                            <button>confirm</button>
                          </div>
                          <div>
                            <span  class="ss-span"></span>
                            <button>In transit</button>
                          </div>
                            
                          <div>
                            <span class="ss-span"></span>
                            <button>Delivered</button>
                          </div>
                          <div>
                            <span class="ss-span"></span>
                            <button>confirm</button>
                          </div>
                          <div>
                            <span class="ss-span"></span>
                            <button>Return</button>
                          </div>
                          <div>
                            <span class="ss-span"></span>
                            <button>Cancel</button>
                          </div>
                        
                          <div>
                            <span class="ss-span"></span>
                            <button>Trash</button>
                          </div>
                          
                          <div>
                            <span class="ss-span"></span>
                            <button>pending payment</button>
                          </div>
                          <div>
                            <span class="ss-span"></span>
                            <button>Refunded</button>
                          </div>
                          <div>
                            <span class="ss-span"></span>
                            <button>On hold</button>
                          </div>
                          <div>
                            <span class="ss-span"></span>
                            <button>Draft</button>
                          </div>

                         </div>

                         </div>
                                    <img src="images/pencil.png" alt="edit details" class="ed-dt-btn-tr">
                         </div>

                         <div class="modal-edit-dt">
                          <input type="text" placeholder="phone number" value="${obj.billing.phone}" onfocus="this.setSelectionRange(0, 99999)">
                          <input type="text" placeholder="address" value="${obj.billing.address_1} ${obj.billing.address_2}" onfocus="this.setSelectionRange(0, 99999)">
                          <div>
                          <label>Select your option</lable>
                            <select>
                            <option value="option1">option 1</option>
                            <option value="option1">option 2</option>
                            <option value="option1">option 3</option>
                            <option value="option1">option 4</option>
                          </select>
                          </div>
                          <button class="cng-details">Change address</button>
                          <i class="fa-solid cnl-cross-btn fa-xmark"></i>
                         </div>
                    </div>
                    `;    
              }


              // ------------------- edit details starts here ---------------------------

              let editBtnTr = document.querySelectorAll(".ed-dt-btn-tr");

              editBtnTr.forEach((element, i) => {
                element.addEventListener("click", () => {
                  let modalPage = document.querySelectorAll(".modal-edit-dt");
                  let cnlBtnMd = document.querySelectorAll(".cnl-cross-btn");
                  modalPage[i].style.display = "flex";
                  cnlBtnMd[i].addEventListener("click", () => {
                    modalPage[i].style.display = "none";
                  })
                });
              });

              // ------------------- edit details ends here ---------------------------
              
            // card event starts here

              const orderTopbar = document.querySelectorAll(".o-topbar");
              const orderCard = document.querySelectorAll(".order-card");

              orderTopbar.forEach((e) => {
                e.addEventListener("click", () => {

                  isClick = !isClick;

                  orderTopbar.forEach((ls) => {
                    ls.parentElement.style.height = "80px";
                  });

                  if (isClick) {
                    e.parentElement.style.height = "fit-content";
                  }
                  else {
                    e.parentElement.style.height = "80px"
                  }
                })
              });
              
            // filter starts from here
              // 
              const orderFilterBtn = document.querySelectorAll(".order-tabs-desc button");
              const orderItem = document.querySelectorAll(".order-card");
              const filterBTnSpan = document.querySelectorAll(".order-tabs-desc div > span");
              console.log(filterBTnSpan);

              filterBTnSpan.forEach((e, i) => {
                e.addEventListener("click", () => {

                  filterBTnSpan.forEach(e => {
                    e.style.backgroundColor = "lightgray";
                  })

                  e.style.backgroundColor = "green";



                  orderItem.forEach((el, ind) => {

                    let xlmBtn = orderFilterBtn[i].getAttribute("order-filter");

                    let ordeItemFilterValue = el.getAttribute("order-filter").toLowerCase();

                    console.log(xlmBtn);
                    console.log(ordeItemFilterValue);

                    if (xlmBtn == ordeItemFilterValue) {
                      el.style.display = "block";
                    }else {
                      el.style.display = "none";
                    }

                    if (xlmBtn == "all") {
                      el.style.display = "block"
                    }
                  })



                  

                })
              })



// ------------------- order filtering starts here ---------------------------

              orderItem.forEach((ea) => {

                orderFilterBtn.forEach(e => {
                  e.addEventListener("click", () => {

                    orderFilterBtn.forEach(e => {
                      e.classList.remove("tab-bg");
                    })
                    e.classList.add("tab-bg");

                    let ev = e.getAttribute('order-filter').toLowerCase();
                    if (ev == ea.getAttribute('order-filter')) {
                      ea.style.display = "block";
                    }
                    else {
                      ea.style.display = "none"
                    }

                    if (ev == "all") {
                      ea.style.display = "block";
                    }
                  })
                })
              })

              // filter end here

              // search bar filtering with id 

              document.querySelector(".search-order").addEventListener("input", filterOrderSearch);

              let phoneNumber = document.querySelectorAll(".order-card");


              function filterOrderSearch() {
                phoneNumber.forEach(item => {
                  let input = document.querySelector(".search-order");
                  let searchId = item.getAttribute("id");
                  let phoneNum = item.getAttribute("data-phone");

                  let textValue = searchId || input.value;
                  let phoneValue = phoneNum || input.value;

                  console.log(phoneNum);

                  console.log(searchId);
                  if ((textValue.indexOf(input.value) > -1) || (phoneValue.indexOf(input.value) > -1)) {
                    item.style.display = "";
                  }
                  else {
                    item.style.display = "none";
                    console.log("no found");
                  }

                })

              }
              
            }

          </script>

          <!-- edit order ends here -->
          <div id="order"></div>

          <div class="order-pagination">
            <ul id="pages">
            </ul>
          </div>

        </div>  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
  <script src="main.js?v=1695738008"></script>
</body>
</html>